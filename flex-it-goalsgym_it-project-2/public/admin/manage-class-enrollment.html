<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Class Enrollment | GOALS Gym</title>
    <link rel="icon" type="image/png" href="image/logo2.png">
    <link rel="stylesheet" href="./admin-css/admin-mainpage.css">
    <link rel="stylesheet" href="./admin-css/manage-class-enrollment.css">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>GOALS Gym Admin</h2>
                <p id="adminFullName" class="admin-fullname">Loading...</p>
            </div>
            <nav class="sidebar-nav">
                <a href="./admin-mainpage.html"><span>Dashboard</span></a>
                <a href="./add-classes.html"><span>Add Classes</span></a>
                <a href="./add-member.html"><span>Add Member</span></a>
                <a href="./manage-members.html"><span>Manage Member</span></a>
                <a href="./add-trainer.html"><span>Add Trainer</span></a>
                <a href="./manage-trainer.html"><span>Manage Trainer</span></a>
                <a href="./manage-class-enrollment.html" class="active"><span>Manage Enrollment</span></a>
                <a href="./add-and-view-transaction.html"><span>Add & View Transaction</span></a>
                <a href="./view-classes-and-feedback.html"><span>View Classes</span></a>
                <a href="./trainer-schedule-management.html"><span>Trainer Schedule Management</span></a>
                        <a href="./attendance-checker.html"><span>Attendance System</span></a>
                        <a href="./send-announcement-email.html"><span>Send Announcement</span></a>
                        <a href="./view-logs.html"><span>View Logs</span></a>
                      </nav>        </aside>

        <!-- Header -->
        <header class="header">
            <button class="menu-toggle" id="menuToggle">â˜°</button>
            <h1>Manage Class Enrollment</h1>
            <button class="logout-btn" id="logoutBtn">Logout</button>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <div id="serverStatus" class="server-status">Checking server connection...</div>
                <div id="successMessage" class="success-message"></div>
                <div id="errorMessage" class="error-message"></div>

                <!-- Tabs -->
                <div class="tabs">
                    <button id="listTab" class="tab-btn active">List View</button>
                    <button id="calendarTab" class="tab-btn">Calendar View</button>
                </div>

                <!-- List View -->
                <div id="listView" class="section active">
                    <h2>Enrollment Management</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="classSelect">Select Class:</label>
                            <select id="classSelect" class="form-control">
                                <option value="">Loading classes...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="memberSearch">Search Members:</label>
                            <div class="search-group">
                                <input type="text" id="memberSearch" class="form-control" placeholder="Enter member name or ID">
                                <div id="autocompleteSuggestions" class="autocomplete-suggestions"></div>
                            </div>
                        </div>
                    </div>

                    <div id="sessionDetailsSection" class="session-details" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="sessionDate">Session Date:</label>
                                <div class="date-input-wrapper">
                                    <input type="date" id="sessionDate" class="form-control date-input">
                                    <span class="calendar-icon">ðŸ“…</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="sessionTime">Session Time:</label>
                                <div id="timeSlots" class="time-slots"></div>
                                <select id="sessionTime" class="form-control" style="display:none;">
                                    <option value="">Select Time</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <h3>Available Members (Remaining Sessions > 0)</h3>
                    <div class="member-list">
                        <table>
                            <thead>
                                <tr>
                                    <th><input type="checkbox" id="selectAllMembers"></th>
                                    <th>Member ID</th>
                                    <th>Name</th>
                                    <th>Remaining Sessions</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="membersTableBody">
                                <tr><td colspan="5">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <button id="addToBulkBtn" class="action-button cart-button" disabled>
                        <i class="cart-icon">ðŸ›’</i> Add Selected to Cart
                    </button>

                    <h3>Scheduled Sessions</h3>
                    <div class="member-list">
                        <table>
                            <thead>
                                <tr>
                                    <th>Member ID</th>
                                    <th>Name</th>
                                    <th>Session Date</th>
                                    <th>Session Time</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="sessionsTableBody">
                                <tr><td colspan="6">No sessions yet.</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Calendar View -->
                <div id="calendarView" class="section">
                    <h2>Calendar View</h2>
                    
                    <!-- Calendar Section (Full Width) -->
                    <div class="calendar-container">
                        <div class="form-group">
                            <label for="calendarMonth">Select Month:</label>
                            <div class="date-input-wrapper">
                                <input type="month" id="calendarMonth" class="form-control calendar-month-input">
                                <span class="calendar-icon">ðŸ“…</span>
                            </div>
                        </div>
                        
                        <h4 id="calendarTitle" class="calendar-title">October 2025</h4>
                        
                        <div class="calendar-wrapper">
                            <table class="calendar-table">
                                <thead>
                                    <tr>
                                        <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
                                    </tr>
                                </thead>
                                <tbody id="calendarBody">
                                    <tr><td colspan="7">Loading calendar...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Date Panel (Below Calendar) -->
                    <div id="datePanel" class="date-panel" style="display: none;">
                        <h4 id="panelTitle" class="panel-title">Selected Date: -</h4>
                        
                        <div class="form-group">
                            <label for="panelMemberSelect">Select Members:</label>
                            <select id="panelMemberSelect" class="form-control" multiple size="8">
                                <option value="">Select Members</option>
                            </select>
                        </div>
                        
                        <button id="addPanelToCartBtn" class="action-button cart-button" disabled>
                            <i class="cart-icon">ðŸ›’</i> Add Selection to Cart
                        </button>
                        
                        <div id="classDetails" class="class-details"></div>
                    </div>
                </div>

                <!-- Bulk Enrollment Cart -->
                <div id="bulkEnrollPanel" class="section bulk-panel" style="display: none;">
                    <div class="bulk-header">
                        <h3><i class="cart-icon">ðŸ›’</i> Bulk Enrollment Cart</h3>
                        <button id="clearCartBtn" class="clear-btn">Clear Cart</button>
                    </div>
                    <ul id="bulkEnrollList" class="bulk-list">
                        <!-- Items added by JS -->
                    </ul>
                    <div id="emptyCartMsg" class="empty-cart">
                        Your cart is empty. Add members above!
                    </div>
                    <div class="bulk-footer">
                        <button id="confirmBulkBtn" class="action-button" disabled>
                            <i class="save-icon">ðŸ’¾</i> Bulk Enroll Selected
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../assets/js/form-persistence.js" defer></script>
    <script src="./admin-js/manage-class-enrollment.js"></script>
</body>
</html>
